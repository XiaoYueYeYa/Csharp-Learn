## 事件是什么
事件是基于委托的存在[委托](委托.md)
**事件是委托的安全包裹**
**让委托的使用更具有安全性**
事件的使用更具有安全性
事件 是一种==**特殊的变量类型**==

### 事件的使用
声明语法:
访问修饰符 `event` 委托类型 事件名;
事件的使用:
1.事件是作用 成员变量存在于类中
2.委托怎么用 事件就怎么用
事件相对委托的区别:
**1.不能再类外部 赋值**
**2.不能再类外部 调用**
注意:
它只能作为成员存在于类和接口以及结构体中
```C#
static void TestFun()
{
        
}
```

```C#
class Test
{
    //委托成员变量 用于存储 函数的
    public Action myFun;
    //事件成员变量 用于存储 函数的
    public event Action myEvent;

    public Test()
    {
        //事件的使用和委托 一模一样 只是有些 细微的区别
        myFun = TestFun;
        myFun += TestFun;
        myFun -= TestFun;
        myFun();
        myFun.Invoke();
        myFun = null;

        myEvent = TestFun;
        myEvent += TestFun;
        myEvent -= TestFun;
        myEvent();
        myEvent.Invoke();
        myEvent = null;
    }

    public void TestFun()
    {
        Console.WriteLine("123123");
    }
    public void DoEvent()
    {
        myEvent.Invoke();
    }
}
```

```C#
Test test = new Test();
//委托可以在外部赋值
test.myFun = null;
test.myFun = TestFun;
//事件不能再外部赋值
//test.myEvent = null;
//test.myEvent = TestFun;
//但是可以 去添加或移除记录的函数
test.myEvent += TestFun;
test.myEvent -= TestFun;

//委托可以直接在外部调用
test.myFun();
test.myFun.Invoke();
//事件不能再外部直接调用
//test.myEvent();
//只能在类的内部去封装 调用
test.DoEvent();

Action a = TestFun;
//事件不能作为临时变量在函数中使用
//event Action ae = TestFun;
```

### 为什么有事件
1.防止外部随意置空委托
2.防止外部随意调用委托
3.事件相当于对委托进行了一次封装 让其更加安全

## 总结
事件和委托的区别
事件和委托的使用基本是一模一样的
事件就是特殊的委托
==**主要区别:**==
1.**事件不能再外部使用赋值 = 符号 只能使用+ - 委托 哪里都能用**
2.事件 不能再外部执行 委托哪里都能执行
3.事件 不能作为 函数中的临时变量的 委托可以

---

## 练习
有一个热水器 包含一个加热器 一个报警器 一个显示器
我们给热水器通上电 当水温超过95度时
1.报警器会开始发出语言 告诉你水的温度
2.显示器也会改变水温提示 提示水已经开了

```C#
//热水器
class WaterHeater
{

}
//加热器
class Heater : WaterHeater
{
    public event Action<int> myEvnet;
    //当前温度
    private int value = 0;
    public void AddHot()
    {
        int updateIndex = 0;
        while (true)
        {
            //缓慢加热
            if (updateIndex % 9999999 == 0)
            {
                ++value;
                Console.WriteLine("当前温度{0}",value);
                //加热到100度 停止加热
                if (value == 100)
                {
                    break;
                }
                //当前温度超过95度 触发报警 打印显示信息
                if (value >= 95)
                {
                    if (myEvnet != null)
                    {
                        myEvnet(value);
                    }
                    //如果只想提示显示一次 清空事件容器即可
                    myEvnet = null;
                }
                //隔一段时间 加一点温度
                updateIndex = 0;
            }
            ++updateIndex;
        }
    }
}
//报警器
class Alarm : WaterHeater
{
    public void Ala(int v)
    {
        Console.WriteLine("当前水温{0}度",v);
    }
}
//显示器 
class Display : WaterHeater
{
    public void Dis(int v)
    {
        Console.WriteLine("水开了 当前水温{0}度", v);
    }
}
```

```C#
Console.WriteLine("lesson13_事件_练习");
Heater h = new Heater();
Alarm a = new Alarm();
Display d = new Display();
h.myEvnet += a.Ala;
h.myEvnet += d.Dis;
//开始加热
h.AddHot();
```
